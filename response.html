<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Response</title>
  </head>
  <body>
    <h3>Summary Widget:</h3>
    <iframe
      id="widgetFrame"
      src="niw_case_summary.html"
      style="width: 100%; height: 80vh; border: none"
    ></iframe>

    <script>
      const data = JSON.parse(localStorage.getItem("summaryData"));

      if (!data) {
        alert("No summary data found!");
      }

      // console.log(data);

      // Optional: listen for confirmation from widget
      window.addEventListener("message", (event) => {
        if (event.data.type === "widgetReady") {
          // console.log("Widget ready, sending data...");
          const output = document.getElementById("widgetFrame").contentWindow;
          output.postMessage({ type: "updateSummary", data }, "*");
        }
      });
    </script>
  </body>
</html>
