<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Portfolio</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa; /* Light gray background */
            color: #343a40; /* Darker text for better contrast */
        }
        .header {
            background-color: #ffffff;
            color: #343a40;
            padding: 40px 20px;
            text-align: center;
            border-bottom: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .section {
            margin: 40px 0;
            padding: 25px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .section h2 {
            border-bottom: 2px solid #0d6efd; /* Professional blue */
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #0d6efd;
        }
        /* Style for the final two sections */
        .section-final h2 {
            border-bottom-color: #6f42c1; /* Professional purple */
            color: #6f42c1;
        }
        .edit-btn, .delete-btn {
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 8px;
            color: #6c757d; /* Subtle gray */
        }
        .edit-btn:hover {
            color: #0d6efd; /* Blue on hover */
        }
        .delete-btn:hover {
            color: #dc3545; /* Red on hover for delete */
        }
        .add-btn {
            background-color: #198754; /* Professional green */
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        .add-btn:hover {
            background-color: #157347; /* Darker green on hover */
        }
        .item {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            position: relative;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .item-controls {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
        }
        .editable {
            outline: none;
            flex-grow: 1;
        }
        .editable:focus {
            border-bottom: 1px dashed #0d6efd;
        }
        .connections {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .connect-btn {
            flex: 1;
            min-width: 150px;
            border-color: #0d6efd;
            color: #0d6efd;
        }
        .connect-btn:hover {
            background-color: #0d6efd;
            color: white;
        }
        .offer-letter, .experience-dates, .education-date {
            margin-top: 10px;
            font-size: 0.9rem;
        }
        .experience-dates {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .file-name {
            font-weight: bold;
        }
        footer {
            text-align: center;
            padding: 20px;
            background: #ffffff;
            border-top: 1px solid #dee2e6;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>
            <span id="name" class="editable" contenteditable="true">John Doe</span>
            <i class="fas fa-edit edit-btn" onclick="document.getElementById('name').focus();"></i>
        </h1>
        <p>
            <span id="degree" class="editable" contenteditable="true">Ph.D. in Computer Science, Stanford University</span>
            <i class="fas fa-edit edit-btn" onclick="document.getElementById('degree').focus();"></i>
             (WES Evaluation: <select id="wes" class="form-select-sm">
                <option value="YES" selected>YES</option>
                <option value="NO">NO</option>
                <option value="NotRequired">Not Required</option>
            </select>)
        </p>
    </header>

    <div class="container">
        <section class="section" id="degrees-section">
            <h2>Academic Degrees <button class="add-btn" onclick="addDegree()"><i class="fas fa-plus"></i></button></h2>
            <div id="degrees-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Ph.D. in Computer Science, Stanford University</p>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="awards-section">
            <h2>Awards <button class="add-btn" onclick="addAward()"><i class="fas fa-plus"></i></button></h2>
            <div id="awards-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Best Paper Award, ACM Conference</p>
                    <select class="award-type-select form-select-sm">
                        <option value="International" selected>International</option>
                        <option value="National US">National (US)</option>
                        <option value="National Other">National (Other)</option>
                    </select>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="journals-section">
            <h2>Journal Articles <button class="add-btn" onclick="addJournal()"><i class="fas fa-plus"></i></button></h2>
            <div id="journals-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Article 1: "Advancements in AI", Journal of Machine Learning</p>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="conferences-section">
            <h2>Conference Presentations <button class="add-btn" onclick="addConference()"><i class="fas fa-plus"></i></button></h2>
            <div id="conferences-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Presentation 1: "AI Ethics", NeurIPS</p>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="media-coverage-section">
            <h2>Media Coverage <button class="add-btn" onclick="addMediaCoverage()"><i class="fas fa-plus"></i></button></h2>
            <div id="media_coverage-list">
                <div class="item">
                     <div class="flex-grow-1">
                        <p class="editable" contenteditable="true">"Breakthrough in AI Research", Tech Journal</p>
                        <div class="offer-letter">File: <span class="file-name">None</span> <button class="btn btn-sm btn-secondary upload-btn">Upload PDF</button> <input type="file" class="offer-file" style="display:none;" accept=".pdf"></div>
                    </div>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="scholar-profile-section">
            <h2>Scholarly Profile</h2>
            <div id="scholar-profile-list">
                 <div class="item">
                    <p class="editable" contenteditable="true"><strong>Google Scholar Profile:</strong> <a href="#" contenteditable="false">https://scholar.google.com/citations?user=your_id</a></p>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                    </div>
                </div>
                <div class="item">
                    <p class="editable" contenteditable="true"><strong>Total Citations:</strong> 1500</p>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="patents-books-section">
            <h2>Patents or Books <button class="add-btn" onclick="addPatentOrBook()"><i class="fas fa-plus"></i></button></h2>
            <div id="patents_books-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Patent US123456: "Method for AI-driven data analysis"</p>
                    <select class="year-select form-select-sm"></select>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="projects-section">
            <h2>Projects <button class="add-btn" onclick="addProject()"><i class="fas fa-plus"></i></button></h2>
            <div id="projects-list">
                <div class="item flex-column align-items-start" data-journals="1" data-conferences="1" data-awards="1" data-degrees="1" data-media_coverage="1" data-patents_books="1">
                    <p class="editable" contenteditable="true">Project 1: AI for Healthcare - Aiming to revolutionize diagnostics in the US.</p>
                    <div class="connections">
                        <button class="btn btn-outline-primary connect-btn" data-type="degrees">Degrees (none)</button>
                        <button class="btn btn-outline-primary connect-btn" data-type="journals">Journal Articles (none)</button>
                        <button class="btn btn-outline-primary connect-btn" data-type="conferences">Conference Presentations (none)</button>
                        <button class="btn btn-outline-primary connect-btn" data-type="media_coverage">Media Coverage (none)</button>
                        <button class="btn btn-outline-primary connect-btn" data-type="patents_books">Patents/Books (none)</button>
                        <button class="btn btn-outline-primary connect-btn" data-type="awards">Awards (none)</button>
                    </div>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="section" id="experience-section">
            <h2>Professional Experience <button class="add-btn" onclick="addExperience()"><i class="fas fa-plus"></i></button></h2>
            <div id="experience-list">
                <div class="item flex-column align-items-start">
                    <div class="editable w-100">
                        <p contenteditable="true"><strong>Research Scientist</strong> at <strong>Tech Corp</strong></p>
                        <p contenteditable="true" style="font-size: 0.9rem;">Led AI research teams, managed projects, and published papers on machine learning advancements.</p>
                    </div>
                    <div class="experience-dates">
                        <div>
                            <label class="form-label-sm me-1">From:</label>
                            <select class="year-select form-select-sm"></select>
                        </div>
                        <div>
                            <label class="form-label-sm me-1">To:</label>
                            <select class="year-select-current form-select-sm"></select>
                        </div>
                    </div>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="education-summary-section">
            <h2>Education Summary <button class="add-btn" onclick="addEducationSummary()"><i class="fas fa-plus"></i></button></h2>
            <div id="education-summary-list">
                <div class="item flex-column align-items-start">
                    <p class="editable" contenteditable="true"><strong>Highest Degree:</strong> Ph.D. in Computer Science from Stanford University</p>
                    <div class="education-date">
                        <label class="form-label-sm me-2">Date of Completion:</label>
                        <select class="year-select form-select-sm me-2"></select>
                        <input type="date" class="form-control-sm">
                    </div>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="memberships-section">
            <h2>Membership in Societies <button class="add-btn" onclick="addMembership()"><i class="fas fa-plus"></i></button></h2>
            <div id="memberships-list">
                <div class="item">
                    <p class="editable" contenteditable="true">Member, IEEE Computer Society</p>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section section-final" id="future-positions-section">
            <h2>Potential Future Positions</h2>
            <div id="future-positions-list">
                <div class="item flex-column align-items-start">
                    <p class="editable" contenteditable="true">Senior AI Researcher at Google: Focusing on advanced ML models.</p>
                    <div class="offer-letter">Offer Letter: <span class="file-name">None</span> <button class="btn btn-sm btn-secondary upload-btn">Upload</button> <input type="file" class="offer-file" style="display:none;"></div>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                        <i class="fas fa-trash delete-btn" title="Delete"></i>
                    </div>
                </div>
            </div>
        </section>

        <section class="section section-final" id="future-endeavor-section">
            <h2>Proposed Future Endeavor in the US</h2>
            <div id="future-endeavor-list">
                <div class="item">
                    <p class="editable" contenteditable="true" style="min-height: 100px;">My proposed endeavor involves developing novel machine learning algorithms to address challenges in sustainable energy systems. I plan to establish a research lab that collaborates with both academic institutions and industry leaders to create AI-driven solutions for optimizing renewable energy grids and reducing carbon footprints. This work will contribute significantly to the United States' goals for technological innovation and environmental stewardship.</p>
                    <div class="item-controls">
                        <i class="fas fa-edit edit-btn" title="Edit"></i>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div class="modal fade" id="connectModal" tabindex="-1" aria-labelledby="connectModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="connectModalLabel">Select Items</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="saveSelections()">Save</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Professional Portfolio. All rights reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentType = '';
        let currentProject = null;
        const modalEl = document.getElementById('connectModal');
        const modal = new bootstrap.Modal(modalEl);
        const modalTitle = document.getElementById('connectModalLabel');
        const modalBody = document.getElementById('modal-body');

        // --- Helper Functions ---
        function generateYearOptions(startOffset = 5, endOffset = 70, includeCurrent = false) {
            let options = '';
            if (includeCurrent) {
                options += '<option value="Current">Current</option>';
            }
            const currentYear = new Date().getFullYear();
            for (let i = currentYear + startOffset; i >= currentYear - endOffset; i--) {
                options += `<option value="${i}">${i}</option>`;
            }
            return options;
        }

        function populateYearSelects() {
            const regularYearOptions = generateYearOptions();
            const currentYearOptions = generateYearOptions(5, 70, true);
            document.querySelectorAll('.year-select').forEach(sel => {
                if (sel.innerHTML === "") sel.innerHTML = regularYearOptions;
            });
            document.querySelectorAll('.year-select-current').forEach(sel => {
                if (sel.innerHTML === "") sel.innerHTML = currentYearOptions;
            });
        }

        // --- Connection Modal Logic ---
        function getItems(type) {
            const listId = type + '-list';
            const items = document.querySelectorAll(`#${listId} .item`);
            return Array.from(items).map((item, index) => ({
                id: index + 1,
                title: item.querySelector('p').innerText
            }));
        }

        function updateButton(btn, selected, type) {
            const typeLabels = {
                degrees: { singular: 'Degree', plural: 'Degrees' },
                journals: { singular: 'Journal Article', plural: 'Journal Articles' },
                conferences: { singular: 'Conference Presentation', plural: 'Conference Presentations' },
                awards: { singular: 'Award', plural: 'Awards' },
                media_coverage: { singular: 'Media Coverage', plural: 'Media Coverage' },
                patents_books: { singular: 'Patent/Book', plural: 'Patents/Books' }
            };
            const labels = typeLabels[type];
            if (!selected || selected.length === 0 || selected.every(s => s === '')) {
                btn.innerText = `${labels.plural} (none)`;
            } else {
                const label = selected.length === 1 ? labels.singular : labels.plural;
                btn.innerText = `${label}: ${selected.join(', ')}`;
            }
        }
        
        function initializeButtons() {
            document.querySelectorAll('.connect-btn').forEach(btn => {
                const project = btn.closest('.item');
                const type = btn.dataset.type;
                const selected = project.dataset[type] ? project.dataset[type].split(',') : [];
                updateButton(btn, selected, type);
            });
        }
        
        function attachConnectListeners(element) {
            element.querySelectorAll('.connect-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    currentType = this.dataset.type;
                    currentProject = this.closest('.item');
                    modalTitle.innerText = 'Select ' + currentType.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
                    
                    const items = getItems(currentType);
                    let html = items.length > 0 ? '' : '<p>No items available to connect.</p>';
                    items.forEach(item => {
                        html += `
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="${item.id}" id="select-${currentType}-${item.id}">
                                <label class="form-check-label" for="select-${currentType}-${item.id}">${item.id}: ${item.title}</label>
                            </div>
                        `;
                    });
                    modalBody.innerHTML = html;

                    const currentSelected = currentProject.dataset[currentType] ? currentProject.dataset[currentType].split(',') : [];
                    currentSelected.forEach(id => {
                        const checkbox = document.getElementById(`select-${currentType}-${id}`);
                        if (checkbox) checkbox.checked = true;
                    });

                    modal.show();
                });
            });
        }
        
        function saveSelections() {
            const selected = Array.from(document.querySelectorAll('#modal-body .form-check-input:checked')).map(inp => inp.value);
            currentProject.dataset[currentType] = selected.join(',');
            const btn = currentProject.querySelector(`.connect-btn[data-type="${currentType}"]`);
            updateButton(btn, selected, currentType);
            modal.hide();
        }

        function attachUploadListeners(element) {
            element.querySelectorAll('.upload-btn').forEach(btn => {
                btn.onclick = () => btn.nextElementSibling.click();
            });
            element.querySelectorAll('.offer-file').forEach(inp => {
                inp.onchange = () => {
                    const fileNameSpan = inp.parentElement.querySelector('.file-name');
                    fileNameSpan.innerText = inp.files[0] ? inp.files[0].name : 'None';
                };
            });
        }
        
        // --- Generic Add Item Function ---
        function addItem(listId, content) {
            const list = document.getElementById(listId);
            const newItem = document.createElement('div');
            newItem.className = 'item';
            newItem.innerHTML = content;
            list.appendChild(newItem);
            return newItem;
        }

        // --- Section-specific Add Functions ---
        function addDegree() {
            const content = `
                <p class="editable" contenteditable="true">New Degree, University Name</p>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('degrees-list', content);
        }
        
        function addAward() {
            const content = `
                <p class="editable" contenteditable="true">New Award</p>
                <select class="award-type-select form-select-sm">
                    <option value="International" selected>International</option>
                    <option value="National US">National (US)</option>
                    <option value="National Other">National (Other)</option>
                </select>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('awards-list', content);
        }

        function addJournal() {
            const content = `
                <p class="editable" contenteditable="true">New Journal Article</p>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('journals-list', content);
        }

        function addConference() {
            const content = `
                <p class="editable" contenteditable="true">New Conference Presentation</p>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('conferences-list', content);
        }

        function addMediaCoverage() {
            const content = `
                <div class="flex-grow-1">
                    <p class="editable" contenteditable="true">New Media Coverage, Outlet Name</p>
                    <div class="offer-letter">File: <span class="file-name">None</span> <button class="btn btn-sm btn-secondary upload-btn">Upload PDF</button> <input type="file" class="offer-file" style="display:none;" accept=".pdf"></div>
                </div>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            const newItem = addItem('media_coverage-list', content);
            attachUploadListeners(newItem);
        }

        function addPatentOrBook() {
             const content = `
                <p class="editable" contenteditable="true">New Patent or Book Title</p>
                <select class="year-select form-select-sm">${generateYearOptions()}</select>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('patents_books-list', content);
        }

        function addProject() {
            const content = `
                <p class="editable" contenteditable="true">New Project - Description here.</p>
                <div class="connections">
                    <button class="btn btn-outline-primary connect-btn" data-type="degrees">Degrees (none)</button>
                    <button class="btn btn-outline-primary connect-btn" data-type="journals">Journal Articles (none)</button>
                    <button class="btn btn-outline-primary connect-btn" data-type="conferences">Conference Presentations (none)</button>
                    <button class="btn btn-outline-primary connect-btn" data-type="media_coverage">Media Coverage (none)</button>
                    <button class="btn btn-outline-primary connect-btn" data-type="patents_books">Patents/Books (none)</button>
                    <button class="btn btn-outline-primary connect-btn" data-type="awards">Awards (none)</button>
                </div>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            const newItem = addItem('projects-list', content);
            newItem.classList.add('flex-column', 'align-items-start');
            newItem.dataset.journals = '';
            newItem.dataset.conferences = '';
            newItem.dataset.awards = '';
            newItem.dataset.degrees = '';
            newItem.dataset.media_coverage = '';
            newItem.dataset.patents_books = '';
            attachConnectListeners(newItem);
        }

        function addExperience() {
            const content = `
                <div class="editable w-100">
                    <p contenteditable="true"><strong>New Job Title</strong> at <strong>Company</strong></p>
                    <p contenteditable="true" style="font-size: 0.9rem;">Description of role.</p>
                </div>
                <div class="experience-dates">
                    <div>
                        <label class="form-label-sm me-1">From:</label>
                        <select class="year-select form-select-sm">${generateYearOptions()}</select>
                    </div>
                    <div>
                        <label class="form-label-sm me-1">To:</label>
                        <select class="year-select-current form-select-sm">${generateYearOptions(5, 70, true)}</select>
                    </div>
                </div>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            const newItem = addItem('experience-list', content);
            newItem.classList.add('flex-column', 'align-items-start');
        }

        function addEducationSummary() {
            const content = `
                <p class="editable" contenteditable="true"><strong>Highest Degree:</strong> Degree Name from University</p>
                <div class="education-date">
                    <label class="form-label-sm me-2">Date of Completion:</label>
                    <select class="year-select form-select-sm me-2">${generateYearOptions()}</select>
                    <input type="date" class="form-control-sm">
                </div>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            const newItem = addItem('education-summary-list', content);
            newItem.classList.add('flex-column', 'align-items-start');
        }

        function addMembership() {
            const content = `
                <p class="editable" contenteditable="true">New Membership</p>
                <div class="item-controls">
                    <i class="fas fa-edit edit-btn" title="Edit"></i>
                    <i class="fas fa-trash delete-btn" title="Delete"></i>
                </div>`;
            addItem('memberships-list', content);
        }
        
        // --- Global Event Listeners ---
        document.addEventListener('click', function(e) {
            // Handle Edit Clicks
            if (e.target.matches('.edit-btn')) {
                const item = e.target.closest('.item');
                if (item) {
                     // Preferentially find an editable element within a wrapper if it exists
                    let editable = item.querySelector('.editable[contenteditable="true"], .editable > [contenteditable="true"]');
                    if (!editable) {
                        // Fallback to the first contenteditable element in the item
                        editable = item.querySelector('[contenteditable="true"]');
                    }
                    if(editable) editable.focus();
                }
            }
            // Handle Delete Clicks
            if (e.target.matches('.delete-btn')) {
                const item = e.target.closest('.item');
                if (item && confirm('Are you sure you want to delete this item?')) {
                    item.remove();
                }
            }
        });

        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', function() {
            populateYearSelects();
            initializeButtons();
            attachConnectListeners(document);
            attachUploadListeners(document);
        });
    </script>
</body>
</html>

